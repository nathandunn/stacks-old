#include "DNASeq4.h"

const uchar DiNuc::c2u[256] = {
     0,15,15,15, 15,15,15,15, 15,15,15,15, 15,15,15,15, // 0x
    15,15,15,15, 15,15,15,15, 15,15,15,15, 15,15,15,15, // 1x
    15,15,15,15, 15,15,15,15, 15,15,15,15, 15,15,15,15, // 2x
    15,15,15,15, 15,15,15,15, 15,15,15,15, 15,15,15,15, // 3x
    15, 1,15, 2, 15,15,15, 4, 15,15,15,15, 15,15,15,15, // 4x
    15,15,15,15,  8,15,15,15, 15,15,15,15, 15,15,15,15, // 5x
    15, 1,15, 2, 15,15,15, 4, 15,15,15,15, 15,15,15,15, // 6x
    15,15,15,15,  8,15,15,15, 15,15,15,15, 15,15,15,15, // 7x

    15,15,15,15, 15,15,15,15, 15,15,15,15, 15,15,15,15,
    15,15,15,15, 15,15,15,15, 15,15,15,15, 15,15,15,15,
    15,15,15,15, 15,15,15,15, 15,15,15,15, 15,15,15,15,
    15,15,15,15, 15,15,15,15, 15,15,15,15, 15,15,15,15,
    15,15,15,15, 15,15,15,15, 15,15,15,15, 15,15,15,15,
    15,15,15,15, 15,15,15,15, 15,15,15,15, 15,15,15,15,
    15,15,15,15, 15,15,15,15, 15,15,15,15, 15,15,15,15,
    15,15,15,15, 15,15,15,15, 15,15,15,15, 15,15,15,15
};

const char DiNuc::u2c[16] {
    '\0','A','C','?','G','?','?','?','T','?','?','?','?','?','?','N'
};

DNASeq4::DNASeq4(const char* s, size_t len) : v_() {
    v_.reserve(len/2 + len%2);
    for (size_t i=0; i<len; i+=2)
        v_.push_back(DiNuc(s[i], s[i+1])); //n.b. `s` is null-terminated
}
